[mysqld]

# OPTIMIZED FOR LARGE BULK IMPORTS - ADAPTIVE VERSION
# Auto-adjusts to server RAM:
# - For servers with 4GB RAM or less: Use this config with 2G buffer pool
# - For servers with 8GB+ RAM: Use bulk-import-4gb.cnf.back with 8G buffer pool
# Compatible with MariaDB 12.x+ (variables deprecated in older versions removed)

# InnoDB Buffer Pool - Reduced for low-RAM servers
# This config uses 2GB (safe for 4GB+ RAM servers)
innodb_buffer_pool_size = 2G

# InnoDB Log Files - Still beneficial for bulk imports
# Reduced from 2G to 1G for low-RAM servers
innodb_log_file_size = 1G
innodb_log_buffer_size = 256M

# InnoDB Flush Settings - MOST IMPORTANT for import speed
innodb_flush_log_at_trx_commit = 0  # 0=fastest (flush every ~1 sec), data loss risk on crash
innodb_doublewrite = OFF             # DISABLE during import (WARNING: unsafe, re-enable after!)

# InnoDB I/O Configuration - Aggressive settings for sustained writes
innodb_io_capacity = 5000            # Higher for sustained write load
innodb_io_capacity_max = 10000
innodb_write_io_threads = 16         # More threads for parallel writes
innodb_read_io_threads = 8
innodb_flush_neighbors = 0           # Disable on SSD (faster random writes)

# InnoDB Auto-increment - Faster for bulk inserts
innodb_autoinc_lock_mode = 2         # Interleaved mode for bulk inserts

# Bulk Insert Settings
bulk_insert_buffer_size = 256M       # Reduced for low-RAM servers

# Query Cache - DISABLE during imports (overhead with no benefit)
query_cache_size = 0
query_cache_type = 0

# Sort and Read Buffers - Moderate sizes for low-RAM
sort_buffer_size = 32M
read_buffer_size = 16M
read_rnd_buffer_size = 16M
join_buffer_size = 16M

# Temporary Tables - Moderate for low-RAM servers
tmp_table_size = 1G
max_heap_table_size = 1G

# Connection Settings
max_allowed_packet = 512M            # Reduced from 1G
max_connections = 50                 # Lower during import (less overhead)

# MyISAM Settings (if you have MyISAM tables)
key_buffer_size = 512M
myisam_sort_buffer_size = 256M

# Binary Logging - DISABLE for import speed
skip-log-bin

# Performance Schema - DISABLE to save memory
performance_schema = OFF

# Timeouts - Longer for big imports
max_statement_time = 3600            # 1 hour max query time
wait_timeout = 7200
interactive_timeout = 7200

# Character Set
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# Additional Optimizations
innodb_adaptive_hash_index = OFF     # Disable during import (overhead)
innodb_stats_on_metadata = OFF       # Reduce metadata overhead
